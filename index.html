<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ModCraft AI - Epic Minecraft Modpacks</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <link href="https://fonts.cdnfonts.com/css/minecraftia" rel="stylesheet">
  <style>
    body {
      font-family: 'Minecraftia', sans-serif;
      overflow-x: hidden;
    }
    /* Parallax Background */
    .parallax {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: linear-gradient(to bottom, #4b0082, #1e90ff);
    }
    .parallax-layer {
      position: absolute;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
    }
    .layer-sky { background-image: url('https://i.imgur.com/4Y3z5lP.png'); transform: translateZ(-2px) scale(3); }
    .layer-clouds { background-image: url('https://i.imgur.com/6Q3z8vX.png'); transform: translateZ(-1px) scale(2); opacity: 0.5; }
    .layer-ground { background-image: url('https://i.imgur.com/8Z7k3vN.png'); transform: translateZ(0); bottom: 0; height: 50%; }

    /* Animations */
    @keyframes glow {
      0% { box-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00; }
      50% { box-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00; }
      100% { box-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00; }
    }
    .glow { animation: glow 2s infinite; }
    .btn-minecraft {
      background: #555555;
      border: 2px solid #333333;
      text-transform: uppercase;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn-minecraft:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px #00ff00;
      background: #666666;
    }
    /* Loading Spinner */
    .spinner {
      width: 40px;
      height: 40px;
      background: url('https://i.imgur.com/3z3x5kQ.png') center/cover;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    /* Particles Container */
    #particles-js {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }
    select {
      max-height: 200px;
      background: #555555;
      color: white;
      border: 2px solid #333333;
    }
    option, optgroup {
      background: #555555;
      color: white;
    }
  </style>
</head>
<body class="bg-gray-900 text-white">
  <!-- Parallax Background -->
  <div class="parallax">
    <div class="parallax-layer layer-sky"></div>
    <div class="parallax-layer layer-clouds"></div>
    <div class="parallax-layer layer-ground"></div>
  </div>

  <!-- Particles -->
  <div id="particles-js"></div>

  <!-- Header -->
  <header class="sticky top-0 z-20 bg-gray-800 bg-opacity-80 backdrop-blur-md shadow-lg">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <h1 class="text-3xl glow">ModCraft AI</h1>
      <nav class="flex items-center space-x-4">
        <a href="#home" class="hover:text-green-400">Home</a>
        <a href="#about" class="hover:text-green-400">About</a>
        <button id="theme-toggle" class="p-2 rounded-full bg-gray-600 glow">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
        </button>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8 relative z-10">
    <!-- Input Form -->
    <section id="home" class="bg-gray-800 bg-opacity-90 p-6 rounded-lg shadow-lg mb-8 glow">
      <h2 class="text-4xl mb-4">Craft Your Epic Modpack</h2>
      <p class="text-gray-300 mb-6">Select any Minecraft version and describe your ultimate modpack. Our AI conjures mods, resource packs, and shaders from Modrinth and CurseForge. Older versions may have fewer mods.</p>
      <form id="modpack-form" class="space-y-4">
        <div>
          <label for="minecraft-version" class="block text-sm">Minecraft Version</label>
          <select id="minecraft-version" class="mt-1 block w-full p-2 rounded-md focus:ring-green-500 focus:border-green-500">
            <optgroup label="Modern Versions">
              <option value="1.21">1.21</option>
              <option value="1.20.6">1.20.6</option>
              <option value="1.20.5">1.20.5</option>
              <option value="1.20.4">1.20.4</option>
              <option value="1.20.3">1.20.3</option>
              <option value="1.20.2">1.20.2</option>
              <option value="1.20.1" selected>1.20.1</option>
              <option value="1.20">1.20</option>
              <option value="1.19.4">1.19.4</option>
              <option value="1.19.3">1.19.3</option>
              <option value="1.19.2">1.19.2</option>
              <option value="1.19.1">1.19.1</option>
              <option value="1.19">1.19</option>
              <option value="1.18.2">1.18.2</option>
              <option value="1.18.1">1.18.1</option>
              <option value="1.18">1.18</option>
              <option value="1.17.1">1.17.1</option>
              <option value="1.17">1.17</option>
              <option value="1.16.5">1.16.5</option>
              <option value="1.16.4">1.16.4</option>
              <option value="1.16.3">1.16.3</option>
              <option value="1.16.2">1.16.2</option>
              <option value="1.16.1">1.16.1</option>
            </optgroup>
            <optgroup label="Legacy Versions">
              <option value="1.15.2">1.15.2</option>
              <option value="1.15.1">1.15.1</option>
              <option value="1.15">1.15</option>
              <option value="1.14.4">1.14.4</option>
              <option value="1.14.3">1.14.3</option>
              <option value="1.14.2">1.14.2</option>
              <option value="1.14.1">1.14.1</option>
              <option value="1.14">1.14</option>
              <option value="1.13.2">1.13.2</option>
              <option value="1.13.1">1.13.1</option>
              <option value="1.13">1.13</option>
              <option value="1.12.2">1.12.2</option>
              <option value="1.12.1">1.12.1</option>
              <option value="1.12">1.12</option>
              <option value="1.11.2">1.11.2</option>
              <option value="1.11.1">1.11.1</option>
              <option value="1.11">1.11</option>
              <option value="1.10.2">1.10.2</option>
              <option value="1.10.1">1.10.1</option>
              <option value="1.10">1.10</option>
              <option value="1.9.4">1.9.4</option>
              <option value="1.9.3">1.9.3</option>
              <option value="1.9.2">1.9.2</option>
              <option value="1.9.1">1.9.1</option>
              <option value="1.9">1.9</option>
              <option value="1.8.9">1.8.9</option>
              <option value="1.8.8">1.8.8</option>
              <option value="1.8.7">1.8.7</option>
              <option value="1.8.6">1.8.6</option>
              <option value="1.8.5">1.8.5</option>
              <option value="1.8.4">1.8.4</option>
              <option value="1.8.3">1.8.3</option>
              <option value="1.8.2">1.8.2</option>
              <option value="1.8.1">1.8.1</option>
              <option value="1.8">1.8</option>
              <option value="1.7.10">1.7.10</option>
              <option value="1.7.9">1.7.9</option>
              <option value="1.7.8">1.7.8</option>
              <option value="1.7.7">1.7.7</option>
              <option value="1.7.6">1.7.6</option>
              <option value="1.7.5">1.7.5</option>
              <option value="1.7.4">1.7.4</option>
              <option value="1.7.2">1.7.2</option>
              <option value="1.6.4">1.6.4</option>
              <option value="1.6.2">1.6.2</option>
              <option value="1.6.1">1.6.1</option>
              <option value="1.5.2">1.5.2</option>
              <option value="1.5.1">1.5.1</option>
              <option value="1.5">1.5</option>
              <option value="1.4.7">1.4.7</option>
              <option value="1.4.6">1.4.6</option>
              <option value="1.4.5">1.4.5</option>
              <option value="1.4.4">1.4.4</option>
              <option value="1.4.2">1.4.2</option>
              <option value="1.3.2">1.3.2</option>
              <option value="1.3.1">1.3.1</option>
              <option value="1.2.5">1.2.5</option>
              <option value="1.2.4">1.2.4</option>
              <option value="1.2.3">1.2.3</option>
              <option value="1.2.2">1.2.2</option>
              <option value="1.2.1">1.2.1</option>
              <option value="1.1">1.1</option>
              <option value="1.0">1.0</option>
            </optgroup>
            <optgroup label="Beta Versions">
              <option value="b1.8.1">Beta 1.8.1</option>
              <option value="b1.8">Beta 1.8</option>
              <option value="b1.7.3">Beta 1.7.3</option>
              <option value="b1.7.2">Beta 1.7.2</option>
              <option value="b1.7">Beta 1.7</option>
              <option value="b1.6.6">Beta 1.6.6</option>
              <option value="b1.6.5">Beta 1.6.5</option>
              <option value="b1.6.4">Beta 1.6.4</option>
              <option value="b1.6.3">Beta 1.6.3</option>
              <option value="b1.6.2">Beta 1.6.2</option>
              <option value="b1.6.1">Beta 1.6.1</option>
              <option value="b1.6">Beta 1.6</option>
              <option value="b1.5_01">Beta 1.5_01</option>
              <option value="b1.5">Beta 1.5</option>
              <option value="b1.4_01">Beta 1.4_01</option>
              <option value="b1.4">Beta 1.4</option>
              <option value="b1.3_01">Beta 1.3_01</option>
              <option value="b1.3">Beta 1.3</option>
              <option value="b1.2_02">Beta 1.2_02</option>
              <option value="b1.2_01">Beta 1.2_01</option>
              <option value="b1.2">Beta 1.2</option>
              <option value="b1.1_02">Beta 1.1_02</option>
              <option value="b1.1_01">Beta 1.1_01</option>
              <option value="b1.0_01">Beta 1.0_01</option>
              <option value="b1.0">Beta 1.0</option>
            </optgroup>
            <optgroup label="Alpha Versions">
              <option value="a1.2.6">Alpha 1.2.6</option>
              <option value="a1.2.5">Alpha 1.2.5</option>
              <option value="a1.2.4_01">Alpha 1.2.4_01</option>
              <option value="a1.2.3_04">Alpha 1.2.3_04</option>
              <option value="a1.2.3">Alpha 1.2.3</option>
              <option value="a1.2.2">Alpha 1.2.2</option>
              <option value="a1.2.1_01">Alpha 1.2.1_01</option>
              <option value="a1.2.1">Alpha 1.2.1</option>
              <option value="a1.2.0_02">Alpha 1.2.0_02</option>
              <option value="a1.2.0">Alpha 1.2.0</option>
              <option value="a1.1.2_01">Alpha 1.1.2_01</option>
              <option value="a1.1.2">Alpha 1.1.2</option>
              <option value="a1.1.0">Alpha 1.1.0</option>
              <option value="a1.0.17_04">Alpha 1.0.17_04</option>
              <option value="a1.0.17">Alpha 1.0.17</option>
              <option value="a1.0.16">Alpha 1.0.16</option>
              <option value="a1.0.15">Alpha 1.0.15</option>
              <option value="a1.0.14">Alpha 1.0.14</option>
              <option value="a1.0.11">Alpha 1.0.11</option>
              <option value="a1.0.5_01">Alpha 1.0.5_01</option>
              <option value="a1.0.4">Alpha 1.0.4</option>
            </optgroup>
          </select>
        </div>
        <div>
          <label for="modpack-description" class="block text-sm">Modpack Description</label>
          <textarea id="modpack-description" rows="4" class="mt-1 block w-full p-2 border border-gray-600 rounded-md bg-gray-700 focus:ring-green-500 focus:border-green-500" placeholder="E.g., A fantasy-themed modpack with magic, dragons, and epic quests"></textarea>
        </div>
        <button type="submit" class="w-full btn-minecraft text-white font-bold py-2 px-4 rounded-md">Generate Modpack</button>
      </form>
    </section>

    <!-- Results Section -->
    <section id="results" class="hidden">
      <h2 class="text-4xl mb-4 glow">Your Legendary Modpack</h2>
      <div id="results-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </section>

    <!-- About Section -->
    <section id="about" class="bg-gray-800 bg-opacity-90 p-6 rounded-lg shadow-lg glow">
      <h2 class="text-4xl mb-4">About ModCraft AI</h2>
      <p class="text-gray-300">ModCraft AI is your portal to epic Minecraft adventures, crafting personalized modpacks for any version, from Alpha to the latest realms. Powered by enchanted AI, it pulls mods from Modrinth and CurseForge. Forge your legend today!</p>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 bg-opacity-80 text-white py-4 relative z-10">
    <div class="container mx-auto px-4 text-center">
      <p>Â© 2025 ModCraft AI. Crafted with Enchantment.</p>
    </div>
  </footer>

  <script>
    // Configurable API URL
    const API_URL = 'http://localhost:3000/api/generate'; // Change to your backend URL if different (e.g., http://localhost:5000/api/generate)

    // Theme Toggle
    const themeToggle = document.getElementById('theme-toggle');
    const html = document.documentElement;
    themeToggle.addEventListener('click', () => {
      html.classList.toggle('dark');
      localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
    });
    if (localStorage.getItem('theme') === 'dark') {
      html.classList.add('dark');
    }

    // Particles.js
    particlesJS('particles-js', {
      particles: {
        number: { value: 50, density: { enable: true, value_area: 800 } },
        color: { value: '#00ff00' },
        shape: { type: 'circle' },
        opacity: { value: 0.5, random: true },
        size: { value: 3, random: true },
        move: { enable: true, speed: 2, direction: 'none', random: true }
      },
      interactivity: {
        events: { onhover: { enable: true, mode: 'repulse' } }
      }
    });

    // GSAP Animations
    gsap.from('header', { y: -100, opacity: 0, duration: 1, ease: 'power2.out' });
    gsap.from('#home', { opacity: 0, y: 50, duration: 1, delay: 0.5, ease: 'power2.out' });

    // Form Submission
    const form = document.getElementById('modpack-form');
    const resultsSection = document.getElementById('results');
    const resultsContainer = document.getElementById('results-container');

    async function generateModpack(version, description) {
      // Show loading state
      resultsContainer.innerHTML = '<div class="spinner mx-auto"></div>';
      resultsSection.classList.remove('hidden');
      gsap.fromTo('#results', { opacity: 0, y: 50 }, { opacity: 1, y: 0, duration: 1, ease: 'power2.out' });

      // Mock data fallback
      const mockData = [
        { name: 'Epic Mod', platform: 'Modrinth', url: 'https://modrinth.com/mod/example', description: 'A legendary mod for epic adventures.' },
        { name: 'Mythic Mod', platform: 'CurseForge', url: 'https://www.curseforge.com/minecraft/mc-mods/another', description: 'Unleashes mythical powers.' },
      ];

      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ prompt: description, minecraftVersion: version }),
        });

        if (!response.ok) {
          const errorText = await response.text();
          throw new Error(`Server error: ${response.status} - ${errorText || 'Unknown error'}`);
        }

        const data = await response.json();
        // Use real data if available, otherwise mock data
        const results = data.mods || mockData;

        // Render results with GSAP
        resultsContainer.innerHTML = results.map(item => `
          <div class="bg-gray-800 bg-opacity-90 p-4 rounded-lg shadow-lg glow result-card">
            <h3 class="text-xl font-bold">${item.name}</h3>
            <p class="text-gray-300">${item.description}</p>
            <p class="text-sm text-gray-500">Platform: ${item.platform}</p>
            <a href="${item.url}" target="_blank" class="mt-2 inline-block btn-minecraft text-white py-2 px-4 rounded-md">Download</a>
          </div>
        `).join('');
        gsap.from('.result-card', { opacity: 0, y: 20, stagger: 0.2, duration: 0.5, ease: 'power2.out' });
      } catch (error) {
        let errorMessage = 'An error occurred while generating the modpack.';
        if (error.message.includes('Failed to fetch')) {
          errorMessage = `Unable to connect to the server. Please ensure the backend is running at ${API_URL}. Try starting the server with 'npm run dev' in the backend directory.`;
        } else if (error.message.includes('CORS')) {
          errorMessage = 'Cross-origin request blocked. Please check the backend CORS configuration (ensure cors middleware is enabled).';
        } else if (error.message.includes('Server error')) {
          errorMessage = error.message;
        }
        resultsContainer.innerHTML = `
          <p class="text-red-500">${errorMessage}</p>
          <button id="retry-button" class="mt-4 btn-minecraft text-white py-2 px-4 rounded-md">Try Again</button>
          <button id="mock-button" class="mt-4 btn-minecraft text-white py-2 px-4 rounded-md">Use Mock Data</button>
        `;
        gsap.from('#results-container', { opacity: 0, duration: 0.5 });
        // Retry button
        document.getElementById('retry-button')?.addEventListener('click', () => generateModpack(version, description));
        // Mock data button
        document.getElementById('mock-button')?.addEventListener('click', () => {
          resultsContainer.innerHTML = mockData.map(item => `
            <div class="bg-gray-800 bg-opacity-90 p-4 rounded-lg shadow-lg glow result-card">
              <h3 class="text-xl font-bold">${item.name}</h3>
              <p class="text-gray-300">${item.description}</p>
              <p class="text-sm text-gray-500">Platform: ${item.platform}</p>
              <a href="${item.url}" target="_blank" class="mt-2 inline-block btn-minecraft text-white py-2 px-4 rounded-md">Download</a>
            </div>
          `).join('');
          gsap.from('.result-card', { opacity: 0, y: 20, stagger: 0.2, duration: 0.5, ease: 'power2.out' });
        });
      }
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const version = document.getElementById('minecraft-version').value;
      const description = document.getElementById('modpack-description').value;
      await generateModpack(version, description);
    });
  </script>
</body>
</html>